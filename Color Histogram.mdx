---
{"title":"Color Histogram","publishedOn":"2024-11-28","description":"A **Color Histogram** is a graphical representation of the distribution of colors in an image, widely used in computer vision tasks like image analysis, object recognition, and segmentation. This blog demonstrates how to preprocess images, compute color histograms for RGB channels, and visualize them using Python libraries like OpenCV and Matplotlib. With practical code examples and theoretical insights, you'll learn how to analyze color intensity and frequency, enabling applications in image retrieval, classification, and more."}
---

### **What is a Color Histogram?**



A color histogram is a statistical representation of the frequency of different pixel intensity values in an image, split across color channels like Red, Green, and Blue (RGB).

* It divides the intensity range (0–255) into bins and counts the number of pixels in each bin for each channel.
* The result is three separate histograms, one for each channel, showing the pixel distribution.



**Why are color histograms useful?**



Simplify complex color information into an easy-to-understand format.
Useful for comparing, matching, or analyzing images.
Robust to small transformations like rotation or scaling.



### **Dataset and Preprocessing**



**<u>Dataset</u>:**



We use the `pinecone/image-set` dataset from the Hugging Face library, which contains base64-encoded image data.



**<u>Preprocessing Steps</u>:**



**Decode the image**: Convert the base64 string into a readable format using `b64decode`.
**Load as an image array**: Use OpenCV to convert the binary data into an image array.
**Convert to RGB**: OpenCV loads images in BGR format by default, so we convert it to RGB.


**<u>Code for Preprocessing</u>:**



![](</assets/Color Histogram/image-633d1c53-a967-441f-950d-ab9ed502fede.png>)



### **How to Compute a Color Histogram?**



To calculate a histogram for RGB channels:

Separate the image into Red, Green, and Blue channels.
Use OpenCV’s `calcHist()` function to compute the histogram for each channel.
Normalize the histogram to make it size-independent.


**<u>Code for Calculating Histograms</u>:**



![](</assets/Color Histogram/image-5dae265e-1e58-44ef-8470-0cccf884851c.png>)



**Description**



The build_histogram function processes an image to visualize the distribution of pixel intensities across the Red, Green, and Blue channels. First, it converts the image from BGR to RGB format for correct color representation. It then flattens the image into a 2D vector of pixel values for each channel (Red, Green, and Blue). The function generates three histograms, one for each color channel, displaying the frequency of pixel intensities from 0 to 255. Each histogram is visualized in a subplot with corresponding colors (Red, Green, Blue). The function also displays the RGB version of the image for reference, providing an easy way to analyze the color composition of the image.



![](</assets/Color Histogram/image-966e3760-ff4c-43d1-8c75-0b13d42f2d76.png>)



The `visualise` function is designed to display a query image, its corresponding RGB histogram, and the matched images along with their histograms based on the similarity of feature vectors.



### **Detailed Description:**


**Query Image and Feature Vector:**
   
   * The function takes in two arguments: `query_i`, the index of the query image, and `result_i`, a list of indices of matched images.
   * It retrieves the `query` image from `rgb_images` using the `query_i` index, and calculates a `span` variable to divide the image’s feature vector (contained in `image_vectors`) into three parts, each corresponding to one of the RGB channels.

**Plotting the Query Image and Histogram:**
   
   * The function creates a figure with two subplots: one for the `query` image and one for its RGB histogram.
   * The first subplot displays the query image using `imshow`, with the axis turned off and a title “Query Image”.
   * The second subplot plots the RGB components of the query image’s feature vector, where each component (Red, Green, and Blue) is plotted separately with the corresponding color. Legends are added for clarity.

**Displaying the Matched Images:**
   *
   * A new figure with subplots is created to display the `top_k` matched images (where `top_k` is the number of images in `result_i`).
   * Each matched image is displayed in its own subplot, with the axis turned off and a title “Matched Image X” where X is the index of the matched image.

**Plotting the Histograms for Matched Images:**

   * Another figure with subplots is generated to plot the RGB histograms for each of the matched images. Each histogram shows the frequency distribution of pixel intensities for the Red, Green, and Blue channels, similar to the query image histogram, with legends indicating the color channels.

**Visualization Execution:**
    
    * Finally, the function calls `plt.show()` after each plotting step to display the query image and histograms, followed by the matched images and their histograms.



### **Purpose:**



This function helps in visualizing how the query image compares to its matching images in terms of both visual appearance and color distribution (histogram). By plotting the query image alongside the matched images and their respective histograms, it provides an intuitive understanding of how the feature vectors are related to the images’ color compositions and similarities.



### **Example Execution:**


When `visualise(4, search(4))` is called, it visualizes:
  * The 4th image in `rgb_images` as the query image.
  * Its RGB histogram.
  * The matched images based on the search results for the 4th image.
  * The histograms for each of the matched images, facilitating a detailed comparison between the query image and its matches.



![](</assets/Color Histogram/image-b6f531a0-504d-42a3-a894-76dfdf7346c6.png>)



**Output:**



![](</assets/Color Histogram/image-e8f45016-2103-4456-ab33-ab6c3c942346.png>)



### **Use Cases and Applications:**


**Image Retrieval Systems:**
   Helps in building image search engines that retrieve similar images based on color and feature vectors.

**Content-Based Recommendation Systems:**
   Suggests similar products by analyzing visual characteristics in e-commerce platforms.

**Visual Search Engines:**
   Allows users to find visually similar images by uploading a reference image instead of text.

**Object and Scene Recognition:**
   Assists in identifying or matching objects by comparing color distributions and feature vectors.

**Image Classification and Clustering:**
    Organizes images into categories or groups based on visual similarities.

**Facial Recognition and Identity Verification:**
    Compares facial images for identity verification in security systems.

**Medical Image Analysis:**
    Compares medical images (like MRI or X-rays) for diagnostic purposes.

**Art and Image Similarity Analysis:**
    Compares artwork or designs to find visually similar pieces.

**Image Quality Assessment:**
    Evaluates image quality by comparing color distributions, useful in compression or enhancement tasks.



**\[ FOR CODE PLEASE REFER TO GITHUB PAGE ]**&#x20;